<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Whale Habitat &amp; Vessel Collisions in the Caribbean</title>

  <meta property="description" itemprop="description" content="Whales migrate and raise their young in seascapes that are heavily utilized for cargo transport, ecotourism, and fishing. Perhaps reducing vessel speed in these whale-inhabited zones will reduce ship-whale collisions. Using spatial tools in Python, we investigate the overlap of these two components and calculate the increase in vessel commute time in a hypothetically enforced speed reduction zone."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-04-30"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-04-30"/>
  <meta name="article:author" content="Juliet Cohen"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Whale Habitat &amp; Vessel Collisions in the Caribbean"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Whales migrate and raise their young in seascapes that are heavily utilized for cargo transport, ecotourism, and fishing. Perhaps reducing vessel speed in these whale-inhabited zones will reduce ship-whale collisions. Using spatial tools in Python, we investigate the overlap of these two components and calculate the increase in vessel commute time in a hypothetically enforced speed reduction zone."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Whale Habitat &amp; Vessel Collisions in the Caribbean"/>
  <meta property="twitter:description" content="Whales migrate and raise their young in seascapes that are heavily utilized for cargo transport, ecotourism, and fishing. Perhaps reducing vessel speed in these whale-inhabited zones will reduce ship-whale collisions. Using spatial tools in Python, we investigate the overlap of these two components and calculate the increase in vessel commute time in a hypothetically enforced speed reduction zone."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","preview","categories"]}},"value":[{"type":"character","attributes":{},"value":["Whale Habitat & Vessel Collisions in the Caribbean"]},{"type":"character","attributes":{},"value":["Whales migrate and raise their young in seascapes that are heavily utilized for cargo transport, ecotourism, and fishing. Perhaps reducing vessel speed in these whale-inhabited zones will reduce ship-whale collisions. Using spatial tools in Python, we investigate the overlap of these two components and calculate the increase in vessel commute time in a hypothetically enforced speed reduction zone.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Juliet Cohen"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["2022-04-30"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["outputs/speed_zone_dominica.png"]},{"type":"character","attributes":{},"value":["Python","Spatial Analysis"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["outputs/boat.jpeg","outputs/dominica_outline.png","outputs/dominica.png","outputs/fine_grid.png","outputs/grid.png","outputs/hull_poly.png","outputs/speed_zone_dominica.png","outputs/sperm_whale.png","outputs/subset_union.png","outputs/vessel_data.png","outputs/vessel_points.png","outputs/vessels_shifted.png","whalesdominica_files/anchor-4.2.2/anchor.min.js","whalesdominica_files/bowser-1.9.3/bowser.min.js","whalesdominica_files/distill-2.2.21/template.v2.js","whalesdominica_files/header-attrs-2.13/header-attrs.js","whalesdominica_files/jquery-3.6.0/jquery-3.6.0.js","whalesdominica_files/jquery-3.6.0/jquery-3.6.0.min.js","whalesdominica_files/jquery-3.6.0/jquery-3.6.0.min.map","whalesdominica_files/popper-2.6.0/popper.min.js","whalesdominica_files/tippy-6.2.7/tippy-bundle.umd.min.js","whalesdominica_files/tippy-6.2.7/tippy-light-border.css","whalesdominica_files/tippy-6.2.7/tippy.css","whalesdominica_files/tippy-6.2.7/tippy.umd.min.js","whalesdominica_files/webcomponents-2.0.0/webcomponents.js","whalessantabarbara_files/anchor-4.2.2/anchor.min.js","whalessantabarbara_files/bowser-1.9.3/bowser.min.js","whalessantabarbara_files/distill-2.2.21/template.v2.js","whalessantabarbara_files/header-attrs-2.13/header-attrs.js","whalessantabarbara_files/jquery-3.6.0/jquery-3.6.0.js","whalessantabarbara_files/jquery-3.6.0/jquery-3.6.0.min.js","whalessantabarbara_files/jquery-3.6.0/jquery-3.6.0.min.map","whalessantabarbara_files/popper-2.6.0/popper.min.js","whalessantabarbara_files/tippy-6.2.7/tippy-bundle.umd.min.js","whalessantabarbara_files/tippy-6.2.7/tippy-light-border.css","whalessantabarbara_files/tippy-6.2.7/tippy.css","whalessantabarbara_files/tippy-6.2.7/tippy.umd.min.js","whalessantabarbara_files/webcomponents-2.0.0/webcomponents.js","whalessantabarbara.html"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="whalesdominica_files/header-attrs-2.13/header-attrs.js"></script>
  <script src="whalesdominica_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="whalesdominica_files/popper-2.6.0/popper.min.js"></script>
  <link href="whalesdominica_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="whalesdominica_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="whalesdominica_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="whalesdominica_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="whalesdominica_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="whalesdominica_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="whalesdominica_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Whale Habitat & Vessel Collisions in the Caribbean","description":"Whales migrate and raise their young in seascapes that are heavily utilized for cargo transport, ecotourism, and fishing. Perhaps reducing vessel speed in these whale-inhabited zones will reduce ship-whale collisions. Using spatial tools in Python, we investigate the overlap of these two components and calculate the increase in vessel commute time in a hypothetically enforced speed reduction zone.","authors":[{"author":"Juliet Cohen","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-04-30T00:00:00.000-07:00","citationText":"Cohen, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Whale Habitat &amp; Vessel Collisions in the Caribbean</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">Python</div>
<div class="dt=tag">Spatial Analysis</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Whales migrate and raise their young in seascapes that are heavily
utilized for cargo transport, ecotourism, and fishing. Perhaps reducing
vessel speed in these whale-inhabited zones will reduce ship-whale
collisions. Using spatial tools in Python, we investigate the overlap of
these two components and calculate the increase in vessel commute time
in a hypothetically enforced speed reduction zone.</p></p>
</div>

<div class="d-byline">
  Juliet Cohen true 
  
<br/>2022-04-30
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#protecting-whales-from-ships">Protecting Whales from
Ships</a>
<ul>
<li><a href="#load-packages">Load packages</a></li>
<li><a href="#read-in-two-data-files">Read in two data files:</a></li>
<li><a href="#whale-sightings-data">Whale Sightings Data</a></li>
<li><a href="#create-grid">Create Grid</a></li>
<li><a href="#extract-whale-habitat">Extract Whale Habitat</a></li>
<li><a href="#plot-the-speed-reduction-zone">Plot the Speed Reduction
Zone</a></li>
<li><a href="#vessel-data">Vessel Data</a></li>
<li><a href="#calculate-distance-and-speed-of-vessels">Calculate
Distance and Speed of Vessels</a></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
<li><a href="#related-resources">Related Resources</a></li>
<li><a href="#photo-sources">Photo Sources:</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="protecting-whales-from-ships">Protecting Whales from Ships</h2>
<p>In this analysis in Python, we aim to determine the spatial outline
of a speed reduction zone for boats in Dominica, an island country in
the Caribbean that is well-known for its year-round sperm whale
population (<a
href="https://discoverdominica.com/en/lists/35/whale-watching#:~:text=Dominica%20is%20the%20only%20country,the%20calm%20turquoise%20Caribbean%20Sea.">source</a>).
We do this by creating a grid on the seascape with each cell
representing the number of reported whale sightings in that subregion.
We then use automatic identification system data to track the vessel
movement in this same region. Lastly, we calculate the effect of a
hypothetical speed reduction zone on the local traffic.</p>
<center>
<figure>
<img src="outputs/sperm_whale.png" style="width:60.0%"
alt="A sperm whale, the species that migrates though the seascape around Dominica." />
<figcaption aria-hidden="true">A sperm whale, the species that migrates
though the seascape around Dominica.</figcaption>
</figure>
</center>
<h5
id="whales-are-among-the-largest-creatures-on-earth-and-play-vital-roles-in-maintaining-healthy-underwater-ecosystems.-yet-intensive-whaling-over-the-past-200-years-has-brought-many-populations-to-the-brink-of-extinction-and-today-many-species-remain-threatened-or-endangered.-although-hunting-has-decreased-dramatically-over-the-last-century-another-danger-threatens-whales-massive-cargo-ships.-whale-ship-collisions-are-currently-a-leading-cause-of-death-for-large-whales-and-scientists-estimate-that-over-80-blue-humpback-and-fin-whales-are-killed-by-vessel-collisions-on-the-west-coast-of-the-united-states-each-yearas-global-maritime-traffic-continues-to-increase-it-is-critical-that-we-implement-solutions-now-to-protect-endangered-whales.---whale-safe-benioff-ocean-initiative">“Whales
are among the largest creatures on earth and play vital roles in
maintaining healthy underwater ecosystems. Yet, intensive whaling over
the past 200 years has brought many populations to the brink of
extinction, and today many species remain threatened or endangered.
Although hunting has decreased dramatically over the last century,
another danger threatens whales – massive cargo ships. Whale-ship
collisions are currently a leading cause of death for large whales, and
scientists estimate that over 80 blue, humpback, and fin whales are
killed by vessel collisions on the West Coast of the United States each
year…As global maritime traffic continues to increase, it is critical
that we implement solutions now to protect endangered whales.” - <a
href="https://boi.ucsb.edu/active_projects/whale-strikes">Whale Safe,
Benioff Ocean Initiative</a></h5>
<center>
<figure>
<img src="outputs/dominica.png" style="width:70.0%"
alt="Scotts Head, Dominica, a location frequented by sperm whales" />
<figcaption aria-hidden="true">Scotts Head, Dominica, a location
frequented by sperm whales</figcaption>
</figure>
</center>
<p>Let’s open up a fresh Jupyter Notebook and get started investigating
the intersection of whale migration and human marine traffic in
Dominica.</p>
<h3 id="load-packages">Load packages</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Polygon</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span></code></pre></div>
<h3 id="read-in-two-data-files">Read in two data files:</h3>
<ol type="1">
<li>A spatial data file that defines the boundaries of Dominica, the
island country in the Caribbean where our ship &amp; whale investigation
takes place.<br />
</li>
<li>Whale sightings data, which contains times and locations of
approximately 5,000 whale sightings in Dominica between 2008 and
2015.</li>
</ol>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import dominca&#39;s spatial data as a geodataframe</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dominica_outline <span class="op">=</span> gpd.read_file(<span class="st">&#39;data/dominica/dma_admn_adm0_py_s1_dominode_v2.shp&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import sightings as a geodataframe </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sightings <span class="op">=</span> gpd.read_file(<span class="st">&#39;data/sightings2005_2018.csv&#39;</span>)</span></code></pre></div>
<p>Set the coordinate reference systems we will use in this
analysis:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>projected_EPSG <span class="op">=</span> <span class="dv">2002</span>   <span class="co"># Dominica 1945 / British West Indies Grid</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>geodetic_EPSG  <span class="op">=</span> <span class="dv">4326</span>   <span class="co"># WGS 84 (use as default CRS for incoming lat &amp; lon)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># switch to crs 2002</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>dominica_outline <span class="op">=</span> dominica_outline.to_crs(projected_EPSG)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>dominica_outline</span></code></pre></div>
<center>
<img src="outputs/dominica_outline.png" style="width:20.0%" />
</center>
<h3 id="whale-sightings-data">Whale Sightings Data</h3>
<p>Bootstrap the geometries from the latitude &amp; longitude and set
the CRS to <code>EPSG 4326</code> initially, and we will convert it to
2002 when we are done appending the geometries. This ensures that the
latitude and longitude are projected correctly.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sightings_geom <span class="op">=</span> gpd.points_from_xy(x <span class="op">=</span> sightings.Long, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                    y <span class="op">=</span> sightings.Lat, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                    crs <span class="op">=</span> geodetic_EPSG)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># append the geometries to the sightings data</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>sightings <span class="op">=</span> sightings.set_geometry(sightings_geom)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set CRS to local EPSG</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>sightings <span class="op">=</span> sightings.to_crs(epsg <span class="op">=</span> projected_EPSG)</span></code></pre></div>
<h3 id="create-grid">Create Grid</h3>
<p>Create a basic grid object that will be the starting point for the
oceanic grid around Dominica that will be tailored to whale habitat:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">3</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                       dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span></code></pre></div>
<center>
<p><img src="outputs/grid.png" style="width:20.0%" /></p>
</center>
<p>Determine the minimum and maximum <code>x</code> and <code>y</code>
bounds of all sightings using the <code>total_bound()</code>
function:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>minx, miny, maxx, maxy <span class="op">=</span> sightings.total_bounds</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>minx, miny, maxx, maxy</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># total_bounds in meters:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (408480.65208368783, 1532792.7459409237, 498500.3049570159, 1796964.399702923)</span></span></code></pre></div>
<p>Create <code>arrays</code> of the indices of our grid, with the
values denoting the southwest corner of each grid cell:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the grid cell dimensions are 2000 meters in both the x and y direction</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.arange(minx, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               maxx, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>               <span class="dv">2000</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.arange(miny, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>               maxy, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>               <span class="dv">2000</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the corner points into proper cell polygons</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_cell(x, y, cell_size):</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    ring <span class="op">=</span> [</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        (x, y),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        (x <span class="op">+</span> cell_size, y),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        (x <span class="op">+</span> cell_size, y <span class="op">+</span> cell_size),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        (x, y <span class="op">+</span> cell_size)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    cell <span class="op">=</span> Polygon(ring)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cell</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over each combination of x and y coordinates in a nested for loop</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>cells <span class="op">=</span> []</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> xs:</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> y <span class="kw">in</span> ys:</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        cell <span class="op">=</span> make_cell(x, y, <span class="dv">2000</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        cells.append(cell)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> gpd.GeoDataFrame({<span class="st">&#39;geometry&#39;</span>: cells}, </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                        crs <span class="op">=</span> projected_EPSG)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the grid and increase the figure size to better visualize without a fill color</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>grid.boundary.plot(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
<center>
<p><img src="outputs/fine_grid.png" style="width:30.0%" /></p>
</center>
<h3 id="extract-whale-habitat">Extract Whale Habitat</h3>
<p>Execute an inner spatial join of the sightings data, with the grid
being the first dataset named because we want the output to be in grid
cells rather than points:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the join produces a row for each intersection of each grid cell with each sighting</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>joined <span class="op">=</span> grid.sjoin(sightings, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                    how <span class="op">=</span> <span class="st">&quot;inner&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the whale habitat in the form of cells</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>joined.plot(figsize <span class="op">=</span> (<span class="dv">15</span>, <span class="dv">15</span>))</span></code></pre></div>
<p>Group the rows of the joined dataset to be able to count the number
of whale sightings per cell:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">&#39;count&#39;</span>] <span class="op">=</span> joined.groupby(joined.index).count()[<span class="st">&#39;index_right&#39;</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>joined</span></code></pre></div>
<p>Count the minimum and maximum number of whales observed in the grid
cells to get an idea of the range of observations over space:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the max count of whales in 1 cell</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>max_count <span class="op">=</span> grid[<span class="st">&#39;count&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check the minimum count of whales in 1 cell</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>min_count <span class="op">=</span> grid[<span class="st">&#39;count&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check the unique values in the count column to get an idea about the range of the sightings per cell</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>grid[<span class="st">&#39;count&#39;</span>].unique()</span></code></pre></div>
<p>Subsample the grid cells for only those with 20 or mores
observations:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitler the data for only sightings that included more than 20 whales</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>grid_subset <span class="op">=</span> grid[grid[<span class="st">&#39;count&#39;</span>] <span class="op">&gt;</span> <span class="dv">20</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>grid_subset</span></code></pre></div>
<p>Execute a <code>unary union</code> and take the convex hull of that
union to determine a comprehensive speed reduction zone. Next, take the
<code>convex hull</code> of the <code>unary union</code> in order to
desginate the speed reduction zone, essentially rounding out the cell
polygons from the <code>unary union</code>.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unary union</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>grid_subset_union <span class="op">=</span> grid_subset.unary_union</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>grid_subset_union</span></code></pre></div>
<center>
<p><img src="outputs/subset_union.png" style="width:20.0%" /></p>
</center>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convex hull</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>grid_subset_hull_poly <span class="op">=</span> grid_subset_union.convex_hull</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>grid_subset_hull_poly</span></code></pre></div>
<center>
<p><img src="outputs/hull_poly.png" style="width:20.0%" /></p>
</center>
<p>Convert grid_subset_hull to a geodataframe with the local CRS for
Dominica; <code>EPSG 2002</code></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>grid_subset_hull_gdf <span class="op">=</span> gpd.GeoDataFrame(index<span class="op">=</span>[<span class="dv">0</span>], </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                        crs<span class="op">=</span> projected_EPSG, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                        geometry<span class="op">=</span>[grid_subset_hull_poly])</span></code></pre></div>
<h3 id="plot-the-speed-reduction-zone">Plot the Speed Reduction
Zone</h3>
<p>Now that we have determined the grid cells with whale sightings
around Dominica, lets move on to defining the ideal speed reduction
zones for ships in this region. Cargo ships, large fishing vessels, and
ecotourism vessels all pose a threat to whales. If the ships travel
slower and are more vigilant of the surrounding marine life, perhaps we
can find a middle ground in which whales can safely migrate alongside
humans in the marine region around Dominica. To make this compromise, we
aim to determine the portion of the seascape that is most critical to
reduce speed, rather than trying to restrict speeds everywhere, which is
unrealistic as it would be impossible to regulate. Furthermore, if
whales are not observed often in a certain region of the ocea,
restricting speeds there would be more disruptive to human livelihoods
than beneficial to whale movement.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>), </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                       dpi <span class="op">=</span> <span class="dv">200</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ax.set_facecolor(<span class="st">&#39;xkcd:lightblue&#39;</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>grid_subset_hull_gdf.plot(ax <span class="op">=</span> ax, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          facecolor <span class="op">=</span> <span class="st">&#39;None&#39;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>dominica_outline.plot(ax <span class="op">=</span> ax, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                      facecolor <span class="op">=</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Speed Reduction Zone for Whales Near Dominica&#39;</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>          y <span class="op">=</span> <span class="fl">1.04</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Latitude (meters)&#39;</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Longitude (meters)&#39;</span>)</span></code></pre></div>
<center>
<img src="outputs/speed_zone_dominica.png" style="width:30.0%" />
</center>
<p>Now we have completed the whale habitat delineation!</p>
<h3 id="vessel-data">Vessel Data</h3>
<p>Marine commercial vessels or any vessel of at least 300 gross tonnage
are required to be fitted with an “automatic identification system”
receiver to monitor their movement. The beacons emitted from these
transmitters are received, encoded, and archived by terrestrial
stations.</p>
<center>
<p><img src="outputs/boat.jpeg" style="width:60.0%" /></p>
</center>
<p>Similarly to how we used whale sightings to determine the spatial
extent of whale habitat, we will use temporal and spatial aspects of
automatic identification system data to determine vessel speeds in the
same region.</p>
<p>Source of automatic identification system data from vessels in 2015:
the <a href="https://www.thespermwhaleproject.org/">Dominica Sperm Whale
Project</a></p>
<p><a href="https://www.vesselfinder.com/">Source of automatic
identification system data for vessels worldwide</a></p>
<p>Read in the vessel data:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>vessel <span class="op">=</span> gpd.read_file(<span class="st">&#39;data/station1249.csv&#39;</span>)</span></code></pre></div>
<p>Similarly to what we processed the spatial sightings data, here we
bootstrap the vessel geometries from the latitude &amp; longitude and
initially set the CRS to <code>EPSG 4326</code>. We will convert it to
the local <code>EPSG 2002</code> after we append the geometries:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vessel_geom <span class="op">=</span> gpd.points_from_xy(x <span class="op">=</span> vessel.LON, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                 y <span class="op">=</span> vessel.LAT, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                 crs <span class="op">=</span> geodetic_EPSG)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># this generated a geometry array of shapely point geometries from coordinates</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># finish bootstrpping the geometries by appending this geoseries to the whales dataset</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>vessel <span class="op">=</span> vessel.set_geometry(vessel_geom)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>vessel</span></code></pre></div>
<center>
<p><img src="outputs/vessel_data.png" style="width:80.0%" /></p>
</center>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the local CRS</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vessel <span class="op">=</span> vessel.to_crs(projected_EPSG)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the raw vessel points</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>vessel.plot()</span></code></pre></div>
<center>
<p><img src="outputs/vessel_points.png" style="width:20.0%" /></p>
</center>
<p>Subset the vessel data for only the vessels within the area of
interest and format the data to prepare for temporal and spatial
calculations:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>vessel <span class="op">=</span> vessel[vessel.intersects(grid_subset_hull_poly)]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set the TIMESTAMP column to type datetime</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>vessel[<span class="st">&#39;TIMESTAMP&#39;</span>] <span class="op">=</span> pd.to_datetime(vessel[<span class="st">&#39;TIMESTAMP&#39;</span>], </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="bu">format</span> <span class="op">=</span> <span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span></code></pre></div>
<h3 id="calculate-distance-and-speed-of-vessels">Calculate Distance and
Speed of Vessels</h3>
<p>We will calculate the distance between two successive locations of
the same vessel, as well as the time difference between the time stamps
of those two locations. We will use the tried and true equation we have
memorized from middle school:<br />
<code>distance = rate * time</code></p>
<p>First, sort the vessels by their Maritime Mobile Service Identity
(MMSI), which is a unique identification number for each vessel:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>vessel_sorted <span class="op">=</span> vessel.sort_values([<span class="st">&quot;MMSI&quot;</span>, <span class="st">&quot;TIMESTAMP&quot;</span>], </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                   ascending <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a copy of the raw data because we need to shift the columns in the working copy, since we are trying to match 2 timestamps and their respective locations to each singular vessel    </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>vessel_sorted_copy <span class="op">=</span> vessel_sorted.shift()</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>vessel_joined <span class="op">=</span> vessel_sorted.join(vessel_sorted_copy, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                   lsuffix <span class="op">=</span> <span class="st">&#39;_end&#39;</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                                   rsuffix <span class="op">=</span> <span class="st">&#39;_start&#39;</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                                   </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># drop rows in which the MMSI_start does not match MMSI_end, because we can only compare time stamps from the same vessel</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match <span class="op">=</span> vessel_joined[vessel_joined[<span class="st">&#39;MMSI_start&#39;</span>] <span class="op">==</span> vessel_joined[<span class="st">&#39;MMSI_end&#39;</span>]]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># take a look at the dataframe now that it is prepped for speed calculations</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match</span></code></pre></div>
<center>
<img src="outputs/vessels_shifted.png" style="width:80.0%" />
</center>
<p>Clean up the dataframe geometries:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset one of the geometry columns as a geometry type, because the geodataframe only needs 1 geom column specified</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match <span class="op">=</span> vessel_joined_mmsi_match.set_geometry(<span class="st">&#39;geometry_start&#39;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match.crs</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># note: we are still able to do spatial operations with BOTH geometry columns because they are both shapely objects</span></span></code></pre></div>
<p>Calculate the distance between successive locations for each vessel,
using the MMSI:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match[<span class="st">&#39;distance_m&#39;</span>] <span class="op">=</span> vessel_joined_mmsi_match.distance(vessel_joined_mmsi_match[<span class="st">&#39;geometry_end&#39;</span>])</span></code></pre></div>
<p>Calculate the time difference for each vessel from one observation to
the next by subtracting one time stamp from the other:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match[<span class="st">&#39;time_diff&#39;</span>] <span class="op">=</span> (vessel_joined_mmsi_match[<span class="st">&#39;TIMESTAMP_end&#39;</span>] <span class="op">-</span> vessel_joined_mmsi_match[<span class="st">&#39;TIMESTAMP_start&#39;</span>])</span></code></pre></div>
<p>Calculate the average speed in meters per second using (distance) =
(rate)*(time):</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide the distance column by the time_diff column</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match[<span class="st">&#39;speed_m_s&#39;</span>] <span class="op">=</span> vessel_joined_mmsi_match[<span class="st">&#39;distance_m&#39;</span>]<span class="op">/</span>vessel_joined_mmsi_match[<span class="st">&#39;time_diff&#39;</span>].dt.total_seconds()</span></code></pre></div>
<p>What is the time that the distance would have taken at 10 knots?
<code>1 knot = 1 nautical mile</code>, so we convert our meters to
nautical miles and then convert the time to hours.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert distance column units from meters to miles</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>meters_per_nm <span class="op">=</span> <span class="fl">1852.0</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match[<span class="st">&#39;distance_nm&#39;</span>] <span class="op">=</span> vessel_joined_mmsi_match[<span class="st">&#39;distance_m&#39;</span>]<span class="op">/</span>meters_per_nm</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># divide the distance by 10 since we are travelling at 10 times the speed, then multiply that output by 3600 because we want units of seconds </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match[<span class="st">&#39;time_10_nm_s&#39;</span>] <span class="op">=</span> vessel_joined_mmsi_match[<span class="st">&#39;distance_nm&#39;</span>]<span class="op">/</span><span class="dv">10</span><span class="op">*</span><span class="dv">3600</span></span></code></pre></div>
<p>Calculate the difference between the time that it actually took and
how much it would have taken at 10 knots:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subtract the actual time from the predicted time at 10 knots, because we want to figure out how much MORE time would be spent if every vessel traveled at 10 knots</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match[<span class="st">&#39;time_diff_actual_vs_10k&#39;</span>] <span class="op">=</span> (vessel_joined_mmsi_match[<span class="st">&#39;time_10_nm_s&#39;</span>]) <span class="op">-</span> vessel_joined_mmsi_match[<span class="st">&#39;time_diff&#39;</span>].dt.total_seconds()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we want to be able to filter out the differences in times for boats that went SLOWER than 10 knots, we don&#39;t want to sum EVERY time difference</span></span></code></pre></div>
<p>Filter for the times that are greater than zero, because we only want
to calculate the extra time that is spent by those boats that were going
faster than 10 knots that would slow to 10 knots. We do not want to
consider the boats that were already travelling slower than this
speed:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>vessel_joined_mmsi_match <span class="op">=</span> vessel_joined_mmsi_match.loc[vessel_joined_mmsi_match[<span class="st">&#39;time_diff_actual_vs_10k&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>]</span></code></pre></div>
<p>Sum up the time difference values and convert the units from seconds
to days</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(vessel_joined_mmsi_match[<span class="st">&#39;time_diff_actual_vs_10k&#39;</span>]<span class="op">/</span> <span class="dv">60</span><span class="op">/</span><span class="dv">60</span><span class="op">/</span><span class="dv">24</span>)</span></code></pre></div>
<p>The difference between the time that it actually took and how much it
would have taken at 10 knots is approximately 27.87 days, on average.
Mission accomplished.</p>
<p>Can we use this analysis to help support a policy change in Dominica
to enforce a speed reduction zone and protect the vulnerable sperm whale
population? Future investigation of this data might include diving into
the MMSI codes for the vessels to determine which vessels are speeding
more often, revealing which vessels should be targeted in this policy.
Additionally, after such a policy is put into place, we can compare the
whale sightings afterward to those before, and hopefully see an increase
in whale activity!</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<ul>
<li><p>I would like to thank my collaborator on this project, <a
href="https://bren.ucsb.edu/people/sydney-rilum">Sydney Rilum</a> from
the Bren School of Environmental Science and Management, for her
contributions. I will always remember the excessive amount of time we
spent googling coordinate reference systems, adjusting our vessel speed
calculations, and iterating through different grid cell sizes.</p></li>
<li><p>Thank you, Dr. James Frew and Niklas Griessbaum from the Bren
School of Environmental Science and Management, for prompting us to
investigate this question. Your expertise in spatial data science
continues to inspire me to answer more questions like this in my future
career.</p></li>
</ul>
<p>Thank you for following along with this analysis, and please contact
me with any suggestions or comments at my GitHub page <a
href="https://github.com/julietcohen">here</a> or via email (<a
href="mailto:jscohen@bren.ucsb.edu"
class="email">jscohen@bren.ucsb.edu</a>)</p>
<h3 id="related-resources">Related Resources</h3>
<p>If you are interested in acoustic whale monitoring in the Caribbean,
check out <a
href="https://www.frontiersin.org/articles/10.3389/fmars.2019.00347/full">this
paper by Heenehan el al. 2019</a> that discusses Caribbean soundscapes
of these magnificent marine mammals and anthropogenic influences that
challenge their survival.</p>
<p>If you are interested in exploring how migratory whales and human
vessels are being tracked and regulated in the Santa Barbara Channel,
please check out the novel <a href="https://whalesafe.com/">Whale Safe
mapping and analysis tool</a> from the Benioff Ocean Initiative! You can
also subscribe to their weekly emails to stay up-to-date with recent
visual and acoustic whale detections of all the species that live in the
Channel.</p>
<h3 id="photo-sources">Photo Sources:</h3>
<p><a
href="https://www.smithsonianmag.com/smart-news/your-high-end-perfume-likely-part-whale-mucus-180958767/">sperm
whale photo</a></p>
<p><a href="https://www.istockphoto.com/photos/dominica">Scotts Head,
Dominca</a></p>
<p><a
href="https://www.overstockboats.com/classifieds/110-ro-ro-cargo-vessel-in-caribbean-o749.html">cargo
vessel</a></p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
